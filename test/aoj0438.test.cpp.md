---
data:
  _extendedDependsOn: []
  _extendedRequiredBy: []
  _extendedVerifiedWith: []
  _isVerificationFailed: true
  _pathExtension: cpp
  _verificationStatusIcon: ':x:'
  attributes: {}
  bundledCode: "Traceback (most recent call last):\n  File \"/opt/hostedtoolcache/Python/3.9.5/x64/lib/python3.9/site-packages/onlinejudge_verify/documentation/build.py\"\
    , line 71, in _render_source_code_stat\n    bundled_code = language.bundle(stat.path,\
    \ basedir=basedir, options={'include_paths': [basedir]}).decode()\n  File \"/opt/hostedtoolcache/Python/3.9.5/x64/lib/python3.9/site-packages/onlinejudge_verify/languages/cplusplus.py\"\
    , line 187, in bundle\n    bundler.update(path)\n  File \"/opt/hostedtoolcache/Python/3.9.5/x64/lib/python3.9/site-packages/onlinejudge_verify/languages/cplusplus_bundle.py\"\
    , line 401, in update\n    self.update(self._resolve(pathlib.Path(included), included_from=path))\n\
    \  File \"/opt/hostedtoolcache/Python/3.9.5/x64/lib/python3.9/site-packages/onlinejudge_verify/languages/cplusplus_bundle.py\"\
    , line 260, in _resolve\n    raise BundleErrorAt(path, -1, \"no such header\"\
    )\nonlinejudge_verify.languages.cplusplus_bundle.BundleErrorAt: ../string/rolling_hash_ull.cpp:\
    \ line -1: no such header\n"
  code: "#define PROBLEM \"http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=0438\"\
    \n#include <iostream>\n#include <algorithm>\n#include <map>\n#include <set>\n\
    #include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include\
    \ <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing\
    \ uint = unsigned;\nusing ull = unsigned long long;\nusing namespace std;\n\n\
    template<class T> constexpr T INF = ::numeric_limits<T>::max()/32*15+208;\n\n\
    #include \"../string/rolling_hash_ull.cpp\"\n#include \"../util/makev.cpp\"\n\n\
    int main() {\n    int n, m;\n    cin >> n >> m;\n    vector<char> c(n);\n    for\
    \ (auto &&i : c) cin >> i;\n    vector<vector<int>> G(n);\n    for (int i = 0;\
    \ i < m; ++i) {\n        int a, b;\n        scanf(\"%d %d\", &a, &b);\n      \
    \  a--; b--;\n        G[a].emplace_back(b);\n    }\n    rolling_hash_ull ro(n);\n\
    \    int B = 19;\n    auto dp = make_v(B, n, ull(0));\n    auto to = make_v(B,\
    \ n, -1);\n    for (int i = 0; i+1 < n; ++i) {\n        G[i].emplace_back(i+1);\n\
    \    }\n    auto ok = [&](int x, int y){\n        for (int i = B-1; i >= 0; --i)\
    \ {\n            if(~to[i][x] && ~to[i][y] && dp[i][x] == dp[i][y]){\n       \
    \         x = to[i][x], y = to[i][y];\n            }\n        }\n        while(true){\n\
    \            if(c[x] != c[y]) return c[x] < c[y];\n            x = to[0][x], y\
    \ = to[0][y];\n            if(y == -1) return false;\n            if(x == -1)\
    \ return true;\n        }\n    };\n    for (int i = n-1; i >= 0; --i) {\n    \
    \    for (auto &&j : G[i]) {\n            if(to[0][i] == -1 || ok(j, to[0][i]))\
    \ to[0][i] = j;\n        }\n        if(to[0][i] != -1){\n            dp[0][i]\
    \ = c[i];\n            for (int j = 1; j < B; ++j) {\n                to[j][i]\
    \ = to[j-1][to[j-1][i]];\n                if(~to[j][i]) {\n                  \
    \  dp[j][i] = ro.mul(dp[j-1][i], ro.p()[1 << (j-1)])+dp[j-1][to[j-1][i]];\n  \
    \                  if(dp[j][i] >= M) dp[j][i] -= M;\n                }else break;\n\
    \            }\n        }\n    }\n    int x = 0;\n    while(true){\n        cout\
    \ << c[x];\n        if(x == n-1) break;\n        x = to[0][x];\n    }\n    puts(\"\
    \");\n    return 0;\n}\n"
  dependsOn: []
  isVerificationFile: true
  path: test/aoj0438.test.cpp
  requiredBy: []
  timestamp: '1970-01-01 00:00:00+00:00'
  verificationStatus: TEST_WRONG_ANSWER
  verifiedWith: []
documentation_of: test/aoj0438.test.cpp
layout: document
redirect_from:
- /verify/test/aoj0438.test.cpp
- /verify/test/aoj0438.test.cpp.html
title: test/aoj0438.test.cpp
---
